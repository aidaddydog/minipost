<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>minipost · 极简起步</title>
    <style>
      :root { --maxw: 720px; }
      * { box-sizing: border-box; }
      body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans SC", "PingFang SC", "Microsoft Yahei", sans-serif; margin: 0; background: #f6f7f9; color: #111; }
      header { padding: 32px 16px; text-align: center; }
      main { max-width: var(--maxw); margin: 0 auto; background: #fff; padding: 24px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,.05); }
      h1 { margin: 0 0 8px; font-size: 28px; }
      p.lead { color: #555; }
      .card { margin-top: 16px; padding: 16px; border: 1px solid #eee; border-radius: 8px; }
      code, pre { background: #f3f4f6; padding: 2px 6px; border-radius: 6px; }
      footer { text-align: center; color: #777; padding: 24px 16px; }
      .ok { padding: 6px 10px; border-radius: 999px; background: #e8f5e9; display: inline-block; }
      .err { padding: 6px 10px; border-radius: 999px; background: #ffebee; display: inline-block; }
    </style>
  </head>
  <body>
    <header>
      <h1>minipost</h1>
      <p class="lead">极简 · 清晰 · 可复制部署的“换单”起步工程</p>
    </header>
    <main>
      <div class="card">
        <strong>运行状态：</strong>
        <span id="health" class="ok">检测中…</span>
      </div>

      <div class="card">
        <h3>API 示例</h3>
        <pre>POST /api/v1/orders/replace
{
  "original_order_id": "A001",
  "target_channel": "amazon",
  "note": "演示"
}</pre>
        <button id="demoBtn">发送示例请求</button>
        <pre id="demoOut"></pre>
      </div>
    </main>
    <footer>© minipost</footer>

    <script>
      async function check() {
        try {
          const r = await fetch('/api/v1/health');
          const j = await r.json();
          const el = document.getElementById('health');
          if (j.status === 'ok') {
            el.textContent = '健康 · OK';
            el.className = 'ok';
          } else {
            el.textContent = '异常';
            el.className = 'err';
          }
        } catch(e) {
          const el = document.getElementById('health');
          el.textContent = '无法连接后端';
          el.className = 'err';
        }
      }
      check();

      document.getElementById('demoBtn').onclick = async () => {
        const res = await fetch('/api/v1/orders/replace', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ original_order_id: 'A001', target_channel: 'amazon', note: '演示' })
        });
        const txt = await res.text();
        document.getElementById('demoOut').textContent = txt;
      };
    </script>
  </body>
</html>
