# ============================================================
# 文件：minipost_Field V1.1.yaml
# 说明：本文件为「minipost」系统专用**统一标准字段清单**（ERP+OMS+TMS+WMS+换单/转单+财务/结算+集成/审计）。
#       不包含任何第三方平台命名，字段名统一英文 snake_case，配中文字段名与用途说明。
#       已补充：转单号、打印时间、发货时间、发货截止时间、中文品名/英文品名等。
# 用法：作为数据库 / 内外 API / 消息事件 / 报表模型的「单一事实来源（SSoT）」。
# 时间：统一存储为 UTC ISO8601；界面按租户时区渲染。
# ============================================================

meta:
  name: "minipost_Field"
  version: "V1.1"
  released_at: "2025-09-22"
  owner: "minipost"
  description: "minipost 专用字段词表（不含第三方平台命名）。"

conventions:
  naming:
    style: "snake_case"
    id_rule: "所有 *_id 为主键/外键（建议 ULID/UUID）；人读编码 *_code；对外交互编号 *_no"
    time_rule: "*_at 为 datetime（UTC）；*_date 为 date；*_tz 为 IANA 时区字符串"
    money_rule: "金额配套 *_currency（ISO4217）；可选 *_fx_rate、*_base_amount（基础币种）"
    bool_rule: "布尔字段以 is_/has_ 开头"
    unit_rule: "重量 kg；尺寸 cm；体积 cm3；数量保留 3 位小数"
    extend_rule: "租户自定义字段统一使用前缀 ext_ 或落入 ext/json 扩展区"
  tenancy:
    rule: "所有业务表默认含 tenant_id；跨组织含 org_id"

types:
  - { name: id,       desc: "主键/外键（ULID/UUID）" }
  - { name: string,   desc: "文本（可限制长度）" }
  - { name: int,      desc: "整数" }
  - { name: decimal,  desc: "定点小数（金额/数量/重量/尺寸等）" }
  - { name: bool,     desc: "布尔" }
  - { name: date,     desc: "日期（无时区）" }
  - { name: datetime, desc: "日期时间（UTC，ISO8601）" }
  - { name: enum,     desc: "枚举值（候选见 enums）" }
  - { name: json,     desc: "结构化 JSON 对象" }
  - { name: array,    desc: "数组（元素类型按定义）" }

enums:
  status_common: [ draft, active, inactive, archived ]
  yes_no: [ yes, no ]
  gender: [ unknown, male, female ]
  fulfilment_type: [ seller_fulfilled, warehouse_fulfilled, third_party_fulfilled, dropship, self_pickup ]
  order_status: [ pending, paid, packed, allocated, shipped, delivered, completed, canceled, closed, on_hold, exception ]
  payment_status: [ unpaid, partial_paid, paid, refunded, partial_refunded, chargeback ]
  refund_type: [ refund_only, return_and_refund, exchange, resend ]
  shipment_status: [ pending, label_created, picked, packed, out_for_pickup, in_transit, arrived, out_for_delivery, delivered, failed_attempt, returned, lost, exception, canceled ]
  stock_status: [ available, allocated, on_hand, damaged, expired, quarantined, in_transit, on_hold ]
  move_type: [ inbound, outbound, internal, adjustment ]
  qc_result: [ pass, fail, rework, hold ]
  price_type: [ retail, wholesale, vip, promo, bundle ]
  tax_type: [ vat, gst, sales_tax, none ]
  invoice_type: [ normal, vat_special, vat_general, proforma, commercial ]
  incoterm: [ EXW, FCA, FOB, CFR, CIF, DAP, DDP, DDU ]
  transport_mode: [ express, postal, air, sea, rail, truck, multimodal, pickup, local_courier ]
  service_level: [ economy, standard, expedited, priority, same_day, next_day, scheduled ]
  charge_type: [ freight, fuel_surcharge, registration, remote_area, return, redelivery, duty, tax, clearance, storage, pickup, packaging, insurance, service_fee, other ]
  measure_unit: [ piece, set, kg, g, lb, oz, cm, mm, m3 ]
  battery_type: [ none, dry, lithium, lithium_ion, power_bank, other ]
  product_nature: [ general, liquid, powder, paste, magnetic, battery, fragile, oversize, prohibited ]
  risk_level: [ low, medium, high, blocked ]
  address_type: [ shipping, billing, pickup, return, company, warehouse ]
  label_switch_trigger: [ tracking_invalid, route_blocked, overweight, oversize, channel_unavailable, sla_risk, manual ]
  reason_code_common: [ customer_request, out_of_stock, address_issue, payment_issue, carrier_issue, damaged, lost, other ]
  asn_status: [ draft, submitted, in_transit, arrived, receiving, received, putaway, canceled ]
  inbound_status: [ draft, receiving, received, qc, putaway, completed, canceled ]
  outbound_status: [ draft, allocated, picking, picked, packing, packed, shipped, canceled, exception ]
  move_status: [ draft, executing, completed, canceled ]
  putaway_strategy: [ fixed_bin, random_bin, recommended, cross_dock ]
  return_type: [ customer_return, carrier_return, warehouse_return, vendor_return ]
  delivery_pref: [ front_door, reception, neighbor, pickup_point, locker, schedule ]

mixins:
  common_base:
    - { zh: 记录ID,         field: id,           type: id,       desc: "主键；系统唯一标识。" }
    - { zh: 租户ID,         field: tenant_id,    type: id,       desc: "多租户隔离标识。" }
    - { zh: 组织ID,         field: org_id,       type: id,       desc: "业务组织/事业部/分公司标识。" }
    - { zh: 状态,           field: status,       type: enum,     desc: "见 enums.status_common。" }
    - { zh: 版本号,         field: version,      type: int,      desc: "乐观锁版本。" }
    - { zh: 创建时间,       field: created_at,   type: datetime, desc: "UTC。" }
    - { zh: 创建人ID,       field: created_by,   type: id,       desc: "用户ID。" }
    - { zh: 更新时间,       field: updated_at,   type: datetime, desc: "UTC。" }
    - { zh: 更新人ID,       field: updated_by,   type: id,       desc: "用户ID。" }
    - { zh: 备注,           field: remark,       type: string,   desc: "备注/说明。" }
  soft_delete:
    - { zh: 删除时间,       field: deleted_at,   type: datetime, desc: "软删除时间（UTC）。" }
    - { zh: 删除人ID,       field: deleted_by,   type: id,       desc: "软删人。" }
  memo:
    - { zh: 标签集,         field: tags,         type: array,    desc: "字符串标签数组。" }
    - { zh: 元数据,         field: metadata,     type: json,     desc: "非结构化附加信息。" }
    - { zh: 扩展区,         field: ext,          type: json,     desc: "租户自定义扩展对象。" }

structs:
  address:
    - { zh: 国家代码,       field: country_code,  type: string,   desc: "ISO3166-1 alpha-2，如 CN/US。" }
    - { zh: 州/省,          field: state,         type: string,   desc: "州/省/省份。" }
    - { zh: 城市,           field: city,          type: string,   desc: "城市名称。" }
    - { zh: 区/县,          field: district,      type: string,   desc: "区县名称。" }
    - { zh: 街道1,          field: street1,       type: string,   desc: "街道第一行。" }
    - { zh: 街道2,          field: street2,       type: string,   desc: "街道第二行。" }
    - { zh: 街道3,          field: address_line3, type: string,   desc: "第三行（可空）。" }
    - { zh: 街道4,          field: address_line4, type: string,   desc: "第四行（可空）。" }
    - { zh: 门牌号,         field: house_number,  type: string,   desc: "独立门牌/单元号；便于清关/投递。" }
    - { zh: 邮编,           field: postcode,      type: string,   desc: "邮政编码/ZIP。" }
    - { zh: 公司名,         field: company,       type: string,   desc: "" }
    - { zh: 联系人,         field: contact_name,  type: string,   desc: "" }
    - { zh: 联系电话,       field: phone,         type: string,   desc: "" }
    - { zh: 电子邮箱,       field: email,         type: string,   desc: "" }
    - { zh: 身份证/护照号,  field: id_card_no,    type: string,   desc: "本地清关需要时使用。" }
    - { zh: 税号/社保号,    field: id_tax_no,     type: string,   desc: "VAT/CPF/CNPJ/IOSS/EORI 等。" }

  money:
    - { zh: 金额（含税）,   field: amount,        type: decimal,  desc: "本币金额。" }
    - { zh: 币种,           field: currency,      type: string,   desc: "ISO4217，如 CNY/USD/EUR。" }
    - { zh: 基础币种,       field: base_currency, type: string,   desc: "租户基础币种。" }
    - { zh: 汇率,           field: fx_rate,       type: decimal,  desc: "amount*fx_rate=base_amount。" }
    - { zh: 基础币金额,     field: base_amount,   type: decimal,  desc: "" }

  dims:
    - { zh: 净重(kg),       field: weight_kg,             type: decimal,  desc: "实际净重。" }
    - { zh: 毛重(kg),       field: gross_weight_kg,       type: decimal,  desc: "含包材毛重（可空）。" }
    - { zh: 长度(cm),       field: length_cm,             type: decimal,  desc: "" }
    - { zh: 宽度(cm),       field: width_cm,              type: decimal,  desc: "" }
    - { zh: 高度(cm),       field: height_cm,             type: decimal,  desc: "" }
    - { zh: 体积(cm3),      field: volume_cm3,            type: decimal,  desc: "可由 L*W*H 计算。" }
    - { zh: 计费重(kg),     field: chargeable_weight_kg,  type: decimal,  desc: "max(实重, 体积重)。" }

  external_ref:
    - { zh: 销售渠道代码,    field: sales_channel_code,   type: string,   desc: "自定义渠道代号（不含品牌名）。" }
    - { zh: 站点/区域代码,   field: site_code,            type: string,   desc: "渠道站点/区域代号（内部规范）。" }
    - { zh: 店铺内部ID,      field: store_id,             type: id,       desc: "内部店铺ID。" }
    - { zh: 店铺名称,        field: store_name,           type: string,   desc: "" }
    - { zh: 外部店铺标识,    field: external_store_id,    type: string,   desc: "外部系统返回的店铺标识。" }
    - { zh: 外部订单ID,      field: external_order_id,    type: string,   desc: "" }
    - { zh: 外部订单号,      field: external_order_no,    type: string,   desc: "" }

  delivery_preferences:
    - { zh: 配送偏好类型,    field: type,                 type: enum,     desc: "见 enums.delivery_pref。" }
    - { zh: 预约时间窗起,    field: window_from,          type: datetime, desc: "预约配送开始（UTC）。" }
    - { zh: 预约时间窗止,    field: window_to,            type: datetime, desc: "预约配送结束（UTC）。" }
    - { zh: 取件点编码,      field: pickup_point_code,    type: string,   desc: "自提/柜/点编码。" }

entities:

  # ------------------------ 主数据（Master Data） ------------------------
  tenant:
    desc: "租户/公司主数据。"
    fields:
      - { zh: 租户编码,       field: tenant_code,       type: string,   desc: "人读编码；用于展示/编号前缀。" }
      - { zh: 租户名称,       field: tenant_name,       type: string,   desc: "公司/主体名称。" }
      - { zh: 基础币种,       field: base_currency,     type: string,   desc: "ISO4217。" }
      - { zh: 时区,           field: timezone,          type: string,   desc: "IANA 时区。" }
      - { zh: 启用VAT,        field: is_vat_enabled,    type: bool,     desc: "" }

  organization:
    desc: "组织/事业部/仓群。"
    fields:
      - { zh: 组织编码,       field: org_code,          type: string,   desc: "" }
      - { zh: 组织名称,       field: org_name,          type: string,   desc: "" }
      - { zh: 上级组织ID,     field: parent_org_id,     type: id,       desc: "" }

  user:
    desc: "用户/员工。"
    fields:
      - { zh: 用户名,         field: username,          type: string,   desc: "" }
      - { zh: 姓名,           field: full_name,         type: string,   desc: "" }
      - { zh: 性别,           field: gender,            type: enum,     desc: "见 enums.gender。" }
      - { zh: 手机,           field: mobile,            type: string,   desc: "" }
      - { zh: 邮箱,           field: email,             type: string,   desc: "" }
      - { zh: 角色集,         field: role_ids,          type: array,    desc: "id 数组。" }
      - { zh: 是否启用,       field: is_active,         type: bool,     desc: "" }
      - { zh: 上次登录时间,   field: last_login_at,     type: datetime, desc: "" }

  role:
    desc: "角色。"
    fields:
      - { zh: 角色编码,       field: role_code,         type: string,   desc: "" }
      - { zh: 角色名称,       field: role_name,         type: string,   desc: "" }
      - { zh: 权限点,         field: permission_keys,   type: array,    desc: "字符串数组。" }

  customer:
    desc: "客户（B端结算主体或B2C聚合）。"
    fields:
      - { zh: 客户编码,       field: customer_code,     type: string,   desc: "" }
      - { zh: 客户名称,       field: customer_name,     type: string,   desc: "" }
      - { zh: 客户类型,       field: customer_type,     type: string,   desc: "企业/个人等。" }
      - { zh: 信用额度,       field: credit_limit,      type: decimal,  desc: "" }
      - { zh: 账期(天),       field: credit_days,       type: int,      desc: "" }
      - { zh: 结算币种,       field: settle_currency,   type: string,   desc: "" }
      - { zh: 发票抬头,       field: invoice_title,     type: string,   desc: "" }
      - { zh: 税号,           field: vat_no,            type: string,   desc: "" }
      - { zh: 默认收货地址,   field: default_ship_to,   type: json,     desc: "structs.address。" }
      - { zh: 默认账单地址,   field: default_bill_to,   type: json,     desc: "structs.address。" }

  supplier:
    desc: "供应商。"
    fields:
      - { zh: 供应商编码,     field: supplier_code,     type: string,   desc: "" }
      - { zh: 供应商名称,     field: supplier_name,     type: string,   desc: "" }
      - { zh: 联系人,         field: contact_name,      type: string,   desc: "" }
      - { zh: 联系电话,       field: phone,             type: string,   desc: "" }
      - { zh: 账期(天),       field: pay_days,          type: int,      desc: "" }
      - { zh: 默认币种,       field: default_currency,  type: string,   desc: "" }
      - { zh: 默认发货地址,   field: default_ship_from, type: json,     desc: "structs.address。" }

  warehouse:
    desc: "仓库主数据。"
    fields:
      - { zh: 仓库编码,       field: warehouse_code,    type: string,   desc: "" }
      - { zh: 仓库名称,       field: warehouse_name,    type: string,   desc: "" }
      - { zh: 仓库类型,       field: warehouse_type,    type: string,   desc: "自营/第三方/前置/退货等。" }
      - { zh: 地址,           field: address,           type: json,     desc: "structs.address。" }
      - { zh: 时区,           field: timezone,          type: string,   desc: "" }

  bin_location:
    desc: "库位。"
    fields:
      - { zh: 仓库ID,         field: warehouse_id,      type: id,       desc: "" }
      - { zh: 库位编码,       field: bin_code,          type: string,   desc: "" }
      - { zh: 库位类型,       field: bin_type,          type: string,   desc: "拣选/存储/不良/暂存 等。" }

  product_spu:
    desc: "产品（SPU）。"
    fields:
      - { zh: SPU编码,        field: spu_code,          type: string,   desc: "" }
      - { zh: 品牌,           field: brand,             type: string,   desc: "" }
      - { zh: 类目路径,       field: category_path,     type: string,   desc: "如：电子>音频>耳机。" }
      - { zh: 标题(中文),     field: title_zh,          type: string,   desc: "中文标题（便于列表/报表）。" }
      - { zh: 标题(英文),     field: title_en,          type: string,   desc: "英文标题（便于海外站点）。" }
      - { zh: 标题多语言,     field: title_i18n,        type: json,     desc: "多语言标题键值对。" }
      - { zh: 产品属性,       field: attributes,        type: json,     desc: "属性键值对。" }
      - { zh: 开发员ID,       field: developer_user_id, type: id,       desc: "" }

  product_sku:
    desc: "SKU（可对应变体）。"
    fields:
      - { zh: SKU编码,        field: sku,               type: string,   desc: "内部 SKU。" }
      - { zh: 外部SKU,        field: external_sku,      type: string,   desc: "外部系统/店铺 SKU（可空）。" }
      - { zh: 条码,           field: barcode,           type: string,   desc: "EAN/UPC/自编码。" }
      - { zh: 型号,           field: model,             type: string,   desc: "" }
      - { zh: 规格,           field: spec,              type: string,   desc: "" }
      - { zh: 颜色,           field: color,             type: string,   desc: "" }
      - { zh: 尺码,           field: size,              type: string,   desc: "" }
      - { zh: 中文品名,       field: product_name_zh,   type: string,   desc: "通用中文品名（非清关）。" }
      - { zh: 英文品名,       field: product_name_en,   type: string,   desc: "通用英文品名（非清关）。" }
      - { zh: 申报品名(中文), field: declare_name_zh,   type: string,   desc: "清关中文品名（如有）。" }
      - { zh: 申报品名(英文), field: declare_name_en,   type: string,   desc: "清关英文品名。" }
      - { zh: HS编码,         field: hs_code,           type: string,   desc: "" }
      - { zh: 申报要素,       field: declare_elements,  type: json,     desc: "" }
      - { zh: 申报价值,       field: declare_value,     type: decimal,  desc: "" }
      - { zh: 申报币种,       field: declare_currency,  type: string,   desc: "" }
      - { zh: 原产国,         field: origin_country,    type: string,   desc: "ISO 国家代码。" }
      - { zh: 产品性质,       field: product_nature,    type: enum,     desc: "见 enums.product_nature。" }
      - { zh: 电池类型,       field: battery_type,      type: enum,     desc: "" }
      - { zh: 是否带磁,       field: has_magnet,        type: bool,     desc: "" }
      - { zh: 净重(kg),       field: weight_kg,         type: decimal,  desc: "单品净重。" }
      - { zh: 毛重(kg),       field: gross_weight_kg,   type: decimal,  desc: "单品毛重（含包材）。" }
      - { zh: 单品尺寸(cm),   field: size_cm,           type: json,     desc: "{length_cm,width_cm,height_cm}。" }
      - { zh: 外箱装数,       field: master_carton_qty, type: int,      desc: "" }
      - { zh: 外箱尺寸(cm),   field: master_carton_size_cm, type: json, desc: "{length_cm,width_cm,height_cm}。" }
      - { zh: 外箱毛重(kg),   field: master_carton_gw_kg, type: decimal, desc: "" }
      - { zh: 含税价,         field: tax_included_price, type: decimal, desc: "" }
      - { zh: 成本价,         field: cost_price,        type: decimal,  desc: "" }
      - { zh: 售价类型,       field: price_type,        type: enum,     desc: "" }
      - { zh: 安全库存,       field: safety_stock_qty,  type: decimal,  desc: "" }
      - { zh: 采购在途量,     field: qty_in_transit_purchase, type: decimal, desc: "" }

  bundle:
    desc: "组合装/套装（BOM）。"
    fields:
      - { zh: 套装编码,       field: bundle_code,       type: string,   desc: "" }
      - { zh: 组件明细,       field: components,        type: array,    desc: "数组：[{sku,qty}]。" }

  pack_material:
    desc: "包材。"
    fields:
      - { zh: 包材编码,       field: pack_code,         type: string,   desc: "" }
      - { zh: 包材名称,       field: pack_name,         type: string,   desc: "" }
      - { zh: 包材尺寸,       field: size_cm,           type: json,     desc: "{length_cm,width_cm,height_cm}。" }
      - { zh: 自重(kg),       field: weight_kg,         type: decimal,  desc: "" }
      - { zh: 成本,           field: cost,              type: decimal,  desc: "" }

  carrier:
    desc: "承运商/物流服务商。"
    fields:
      - { zh: 承运商编码,     field: carrier_code,      type: string,   desc: "" }
      - { zh: 承运商名称,     field: carrier_name,      type: string,   desc: "" }
      - { zh: 国家/区域,      field: region,            type: string,   desc: "" }
      - { zh: 对接方式,       field: api_type,          type: string,   desc: "api/file/manual 等。" }

  channel:
    desc: "物流渠道（服务）。"
    fields:
      - { zh: 渠道编码,       field: channel_code,      type: string,   desc: "" }
      - { zh: 渠道名称,       field: channel_name,      type: string,   desc: "" }
      - { zh: 承运商ID,       field: carrier_id,        type: id,       desc: "" }
      - { zh: 运输方式,       field: transport_mode,    type: enum,     desc: "" }
      - { zh: 服务等级,       field: service_level,     type: enum,     desc: "" }
      - { zh: 目的国家集,     field: dest_country_codes, type: array,   desc: "ISO 国家数组。" }
      - { zh: 限重(kg),       field: max_weight_kg,     type: decimal,  desc: "" }
      - { zh: 限边(cm),       field: max_side_cm,       type: decimal,  desc: "" }
      - { zh: 限周长(cm),     field: max_girth_cm,      type: decimal,  desc: "" }
      - { zh: 支持电池,       field: support_battery,   type: bool,     desc: "" }

  store:
    desc: "销售店铺（渠道账户）。"
    fields:
      - { zh: 店铺编码,       field: store_code,        type: string,   desc: "" }
      - { zh: 店铺名称,       field: store_name,        type: string,   desc: "" }
      - { zh: 销售渠道代码,   field: sales_channel_code, type: string,  desc: "自定义渠道代号。" }
      - { zh: 站点代码,       field: site_code,         type: string,   desc: "" }
      - { zh: 外部店铺标识,   field: external_store_id, type: string,   desc: "" }
      - { zh: 授权配置,       field: auth_config,       type: json,     desc: "密钥/token/回调等。" }

  # ------------------------ OMS（订单/履约） ------------------------
  sales_order:
    desc: "销售订单（主表）。"
    fields:
      - { zh: 订单号(系统),    field: order_no,          type: string,   desc: "系统内部订单编号。" }
      - { zh: 客户ID,          field: customer_id,       type: id,       desc: "B2B 结算客户；B2C 可空。" }
      - { zh: 客户单号,        field: customer_order_no, type: string,   desc: "客户/买家提供的单号。" }
      - { zh: 外部引用,        field: external_ref,      type: json,     desc: "structs.external_ref；外部标识统一入口。" }
      - { zh: 外部子订单号,    field: external_sub_order_no, type: string, desc: "外部系统子单/行号（可空）。" }
      - { zh: 买家ID/账号,     field: buyer_ref,         type: string,   desc: "外部系统买家标识（可空）。" }
      - { zh: 订单类型,        field: order_type,        type: string,   desc: "普通/预售/补发/换货 等。" }
      - { zh: 订单属性,        field: order_attr,        type: string,   desc: "COD/礼品单/合单 等标签。" }
      - { zh: 履约方式,        field: fulfilment_type,   type: enum,     desc: "见 enums.fulfilment_type。" }
      - { zh: 订单状态,        field: order_status,      type: enum,     desc: "见 enums.order_status。" }
      - { zh: 付款状态,        field: payment_status,    type: enum,     desc: "见 enums.payment_status。" }
      - { zh: 支付时间,        field: paid_at,           type: datetime, desc: "买家付款完成时间。" }
      - { zh: 支付流水号,      field: transaction_no,    type: string,   desc: "第三方支付交易号（非品牌名）。" }
      - { zh: 支付方式,        field: payment_method,    type: string,   desc: "银行卡/钱包/COD 等。" }
      - { zh: 币种,            field: currency,          type: string,   desc: "ISO4217。" }
      - { zh: 订单总额,        field: order_amount,      type: decimal,  desc: "含税含运费。" }
      - { zh: 商品金额,        field: items_amount,      type: decimal,  desc: "" }
      - { zh: 运费金额,        field: shipping_amount,   type: decimal,  desc: "" }
      - { zh: 税费金额,        field: tax_amount,        type: decimal,  desc: "" }
      - { zh: 折扣金额,        field: discount_amount,   type: decimal,  desc: "" }
      - { zh: COD金额,         field: cod_amount,        type: decimal,  desc: "" }
      - { zh: 优惠券代码,      field: coupon_code,       type: string,   desc: "" }
      - { zh: 优惠券金额,      field: coupon_amount,     type: decimal,  desc: "" }
      - { zh: 原币种,          field: original_currency, type: string,   desc: "外部系统原始币种（可空）。" }
      - { zh: 原币总额,        field: original_amount,   type: decimal,  desc: "外部系统原币金额（可空）。" }
      - { zh: 下单时间,        field: ordered_at,        type: datetime, desc: "" }
      - { zh: 接单时间,        field: accepted_at,       type: datetime, desc: "" }
      - { zh: 发货时间,        field: shipped_at,        type: datetime, desc: "订单首包裹/任一包裹发出时间（快照）。" }
      - { zh: 发货截止时间,    field: ship_deadline_at,  type: datetime, desc: "SLA ship-by 截止时间（系统计算/平台要求）。" }
      - { zh: 订单打印时间,    field: order_printed_at,  type: datetime, desc: "订单/装箱单等被实际打印的时间（可多次，取最近）。" }
      - { zh: 买家留言,        field: buyer_message,     type: string,   desc: "" }
      - { zh: 卖家备注,        field: seller_note,       type: string,   desc: "" }
      - { zh: 收货地址,        field: ship_to,           type: json,     desc: "structs.address。" }
      - { zh: 账单地址,        field: bill_to,           type: json,     desc: "structs.address。" }
      - { zh: 买家自选物流,    field: buyer_selected_shipping, type: string, desc: "买家偏好运输方式（非渠道名）。" }
      - { zh: 期望发货时间,    field: expect_ship_at,    type: datetime, desc: "" }
      - { zh: SLA时效(天),     field: sla_days,          type: decimal,  desc: "" }
      - { zh: 配送偏好,        field: delivery_prefs,    type: json,     desc: "structs.delivery_preferences。" }
      - { zh: 开发员ID,        field: developer_user_id, type: id,       desc: "" }
      - { zh: 销售员ID,        field: sales_user_id,     type: id,       desc: "" }
      - { zh: 附属销售员,      field: sales_assistant_user_ids, type: array, desc: "ID 数组。" }

  sales_order_item:
    desc: "销售订单行。"
    fields:
      - { zh: 销售订单ID,     field: sales_order_id,    type: id,       desc: "" }
      - { zh: 行号,           field: line_no,           type: int,      desc: "" }
      - { zh: SKU,            field: sku,               type: string,   desc: "" }
      - { zh: 外部SKU,        field: external_sku,      type: string,   desc: "" }
      - { zh: 商品名称,       field: item_name,         type: string,   desc: "下单时名称快照（可多语言在 ext）。" }
      - { zh: 变体属性,       field: variant_attrs,     type: json,     desc: "{color,size,...}" }
      - { zh: 数量,           field: qty,               type: decimal,  desc: "" }
      - { zh: 单价,           field: unit_price,        type: decimal,  desc: "" }
      - { zh: 金额小计,       field: line_amount,       type: decimal,  desc: "" }
      - { zh: 折扣,           field: line_discount,     type: decimal,  desc: "" }
      - { zh: 税额,           field: line_tax,          type: decimal,  desc: "" }
      - { zh: 申报快照,       field: declare_snapshot,  type: json,     desc: "清关申报信息快照（含中英文品名）。" }
      - { zh: 仓库ID,         field: warehouse_id,      type: id,       desc: "" }
      - { zh: 期望发货时间,   field: expect_ship_at,    type: datetime, desc: "" }
      - { zh: 发货截止时间,   field: ship_deadline_at,  type: datetime, desc: "行维度 ship-by 截止。" }
      - { zh: 商品备注,       field: item_note,         type: string,   desc: "" }

  shipment_request:
    desc: "发货申请（拣配入口）。"
    fields:
      - { zh: 来源订单ID,     field: source_order_id,   type: id,       desc: "" }
      - { zh: 发货类型,       field: ship_type,         type: string,   desc: "销售/补发/换货。" }
      - { zh: 目标仓库ID,     field: warehouse_id,      type: id,       desc: "" }
      - { zh: 拣配优先级,     field: priority,          type: int,      desc: "" }
      - { zh: 拦截标记,       field: is_intercepted,    type: bool,     desc: "" }
      - { zh: 拦截原因,       field: intercept_reason,  type: string,   desc: "" }

  picking_batch:
    desc: "波次/拣货批次。"
    fields:
      - { zh: 仓库ID,         field: warehouse_id,      type: id,       desc: "" }
      - { zh: 批次编号,       field: batch_code,        type: string,   desc: "" }
      - { zh: 规则快照,       field: rule_snapshot,     type: json,     desc: "" }

  pick_list:
    desc: "拣货单。"
    fields:
      - { zh: 波次ID,         field: picking_batch_id,  type: id,       desc: "" }
      - { zh: 拣货单号,       field: pick_list_no,      type: string,   desc: "" }
      - { zh: 拣货员ID,       field: picker_id,         type: id,       desc: "" }
      - { zh: 拣货单打印时间,  field: pick_list_printed_at, type: datetime, desc: "拣货单被实际打印的时间（UTC）。" }

  package:
    desc: "包裹（出库装箱结果）。"
    fields:
      - { zh: 包裹号,         field: package_no,        type: string,   desc: "" }
      - { zh: 关联订单ID,     field: sales_order_id,    type: id,       desc: "" }
      - { zh: 渠道ID,         field: channel_id,        type: id,       desc: "" }
      - { zh: 打包人ID,       field: packer_id,         type: id,       desc: "" }
      - { zh: 包材编码,       field: pack_code,         type: string,   desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,qty}]。" }
      - { zh: 实重(kg),       field: weight_kg,         type: decimal,  desc: "" }
      - { zh: 尺寸(cm),       field: size_cm,           type: json,     desc: "{length_cm,width_cm,height_cm}。" }
      - { zh: 计费重(kg),     field: chargeable_weight_kg, type: decimal, desc: "" }

  label:
    desc: "面单（电子运单标签）。"
    fields:
      - { zh: 跟踪号/面单号,   field: tracking_no,       type: string,   desc: "" }
      - { zh: 包裹ID,         field: package_id,        type: id,       desc: "" }
      - { zh: 承运商ID,       field: carrier_id,        type: id,       desc: "" }
      - { zh: 渠道ID,         field: channel_id,        type: id,       desc: "" }
      - { zh: 标签文件,       field: label_file,        type: string,   desc: "存储键/URL。" }
      - { zh: 标签生成时间,    field: label_created_at,  type: datetime, desc: "标签成功生成时间（UTC）。" }
      - { zh: 标签打印时间,    field: label_printed_at,  type: datetime, desc: "面单被实际打印的时间（UTC）。" }
      - { zh: 转单号,         field: transfer_waybill_no, type: string, desc: "换单/渠道改签后的转单编号（可冗余存放）。" }

  tracking_event:
    desc: "物流轨迹事件。"
    fields:
      - { zh: 跟踪号,         field: tracking_no,       type: string,   desc: "" }
      - { zh: 事件代码,       field: event_code,        type: string,   desc: "" }
      - { zh: 事件描述,       field: event_desc,        type: string,   desc: "" }
      - { zh: 国家代码,       field: country_code,      type: string,   desc: "" }
      - { zh: 发生时间,       field: occurred_at,       type: datetime, desc: "" }
      - { zh: 上报时间,       field: reported_at,       type: datetime, desc: "" }

  rma:
    desc: "售后（退货/退款/换货/重发）。"
    fields:
      - { zh: 关联订单ID,     field: sales_order_id,    type: id,       desc: "" }
      - { zh: 售后类型,       field: refund_type,       type: enum,     desc: "见 enums.refund_type；含 resend 重发。" }
      - { zh: 原因代码,       field: reason_code,       type: enum,     desc: "见 enums.reason_code_common。" }
      - { zh: 退款金额,       field: refund_amount,     type: decimal,  desc: "" }
      - { zh: 退款币种,       field: refund_currency,   type: string,   desc: "" }
      - { zh: 重发来源单号,   field: resend_from_order_no, type: string, desc: "" }
      - { zh: 重发原因,       field: resend_reason,     type: string,   desc: "" }
      - { zh: 退货仓ID,       field: return_warehouse_id, type: id,     desc: "" }
      - { zh: 客退物流单号,   field: return_tracking_no, type: string,  desc: "" }

  # ------------------------ ERP（采购/库存/财务） ------------------------
  purchase_order:
    desc: "采购单（主表）。"
    fields:
      - { zh: 采购单号,       field: po_no,             type: string,   desc: "" }
      - { zh: 供应商ID,       field: supplier_id,       type: id,       desc: "" }
      - { zh: 下单日期,       field: order_date,        type: date,     desc: "" }
      - { zh: 预计到货日期,   field: eta_date,          type: date,     desc: "" }
      - { zh: 采购周期(天),   field: lead_time_days,    type: int,      desc: "" }
      - { zh: 币种,           field: currency,          type: string,   desc: "" }
      - { zh: 税率(%),        field: tax_rate_pct,      type: decimal,  desc: "" }
      - { zh: 采购总额,       field: total_amount,      type: decimal,  desc: "" }
      - { zh: 付款状态,       field: payment_status,    type: enum,     desc: "" }

  purchase_order_item:
    desc: "采购单行。"
    fields:
      - { zh: 采购单ID,       field: purchase_order_id, type: id,       desc: "" }
      - { zh: 行号,           field: line_no,           type: int,      desc: "" }
      - { zh: SKU,            field: sku,               type: string,   desc: "" }
      - { zh: 数量,           field: qty,               type: decimal,  desc: "" }
      - { zh: 含税单价,       field: unit_price,        type: decimal,  desc: "" }
      - { zh: 小计金额,       field: line_amount,       type: decimal,  desc: "" }
      - { zh: 期望到货仓,     field: warehouse_id,      type: id,       desc: "" }

  receiving:
    desc: "到货/收货记录（简化）。"
    fields:
      - { zh: 关联采购单ID,   field: purchase_order_id, type: id,       desc: "" }
      - { zh: 收货单号,       field: grn_no,            type: string,   desc: "" }
      - { zh: 收货时间,       field: received_at,       type: datetime, desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,qty,quality_status}]。" }

  putaway:
    desc: "上架任务（简化）。"
    fields:
      - { zh: 收货单ID,       field: receiving_id,      type: id,       desc: "" }
      - { zh: 上架人ID,       field: operator_id,       type: id,       desc: "" }
      - { zh: 目标库位,       field: bin_code,          type: string,   desc: "" }

  inventory:
    desc: "库存余额（按仓/库位/批次/序列）。"
    fields:
      - { zh: 仓库ID,         field: warehouse_id,      type: id,       desc: "" }
      - { zh: 库位编码,       field: bin_code,          type: string,   desc: "" }
      - { zh: SKU,            field: sku,               type: string,   desc: "" }
      - { zh: 批次号,         field: lot_no,            type: string,   desc: "" }
      - { zh: 序列号,         field: serial_no,         type: string,   desc: "" }
      - { zh: 可用数量,       field: qty_available,     type: decimal,  desc: "" }
      - { zh: 预留数量,       field: qty_allocated,     type: decimal,  desc: "" }
      - { zh: 不良数量,       field: qty_damaged,       type: decimal,  desc: "" }
      - { zh: 采购在途量,     field: qty_in_transit_purchase, type: decimal, desc: "" }
      - { zh: 调拨在途量,     field: qty_in_transit_transfer, type: decimal, desc: "" }
      - { zh: 失效日期,       field: expiry_date,       type: date,     desc: "" }
      - { zh: 成本单价,       field: unit_cost,         type: decimal,  desc: "" }

  stock_ledger:
    desc: "库存流水（移动/记账）。"
    fields:
      - { zh: 发生时间,       field: occurred_at,       type: datetime, desc: "" }
      - { zh: 移动类型,       field: move_type,         type: enum,     desc: "" }
      - { zh: 关联单据,       field: ref_doc,           type: json,     desc: "{type,id,no}。" }
      - { zh: SKU,            field: sku,               type: string,   desc: "" }
      - { zh: 数量变动,       field: qty_delta,         type: decimal,  desc: "正入负出。" }
      - { zh: 成本变动,       field: cost_delta,        type: decimal,  desc: "" }

  transfer_order:
    desc: "调拨单。"
    fields:
      - { zh: 调出仓ID,       field: from_warehouse_id, type: id,       desc: "" }
      - { zh: 调入仓ID,       field: to_warehouse_id,   type: id,       desc: "" }
      - { zh: 调拨单号,       field: transfer_no,       type: string,   desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,qty}]。" }

  stock_count:
    desc: "盘点单。"
    fields:
      - { zh: 盘点单号,       field: count_no,          type: string,   desc: "" }
      - { zh: 盘点范围,       field: scope,             type: string,   desc: "全仓/库区/库位/SKU 等。" }
      - { zh: 差异明细,       field: diffs,             type: array,    desc: "数组：[{sku,qty_sys,qty_phy,qty_diff}]。" }

  qc_inspection:
    desc: "质检单。"
    fields:
      - { zh: 关联单据,       field: ref_doc,           type: json,     desc: "{type,id,no}；如收货/退货等。" }
      - { zh: 检验结果,       field: qc_result,         type: enum,     desc: "" }
      - { zh: 不良原因,       field: defect_reason,     type: string,   desc: "" }
      - { zh: 抽检比例(%),    field: sample_pct,        type: decimal,  desc: "" }

  ar_invoice:
    desc: "应收（客户发票/账单）。"
    fields:
      - { zh: 应收单号,       field: ar_no,             type: string,   desc: "" }
      - { zh: 客户ID,         field: customer_id,       type: id,       desc: "" }
      - { zh: 发票类型,       field: invoice_type,      type: enum,     desc: "" }
      - { zh: 含税金额,       field: amount,            type: decimal,  desc: "" }
      - { zh: 币种,           field: currency,          type: string,   desc: "" }
      - { zh: 开票日期,       field: invoice_date,      type: date,     desc: "" }
      - { zh: 到期日,         field: due_date,          type: date,     desc: "" }
      - { zh: 付款状态,       field: payment_status,    type: enum,     desc: "" }

  ap_bill:
    desc: "应付（供应商/承运商费用）。"
    fields:
      - { zh: 应付单号,       field: ap_no,             type: string,   desc: "" }
      - { zh: 供应商/承运商ID, field: vendor_id,        type: id,       desc: "" }
      - { zh: 费用明细,       field: charges,           type: array,    desc: "数组：[{type,amount,currency}]；见 enums.charge_type。" }
      - { zh: 发票号,         field: invoice_no,        type: string,   desc: "" }
      - { zh: 付款状态,       field: payment_status,    type: enum,     desc: "" }
      - { zh: 账期到期日,     field: due_date,          type: date,     desc: "" }

  payment:
    desc: "收付款记录。"
    fields:
      - { zh: 方向,           field: direction,         type: string,   desc: "in/out。" }
      - { zh: 金额,           field: amount,            type: decimal,  desc: "" }
      - { zh: 币种,           field: currency,          type: string,   desc: "" }
      - { zh: 账户,           field: account,           type: string,   desc: "银行/支付账户。" }
      - { zh: 交易号,         field: transaction_no,    type: string,   desc: "" }
      - { zh: 支付时间,       field: paid_at,           type: datetime, desc: "" }
      - { zh: 关联单据,       field: ref_doc,           type: json,     desc: "{type,id,no}。" }

  # ------------------------ TMS（运输/清关/结算） ------------------------
  waybill:
    desc: "运单（跨境运输核心）。"
    fields:
      - { zh: 运单号,         field: waybill_no,        type: string,   desc: "" }
      - { zh: 跟踪号,         field: tracking_no,       type: string,   desc: "" }
      - { zh: 转单号,         field: transfer_waybill_no, type: string, desc: "换单/转签后分配的转单编号。", aliases: ["transfer_tracking_no"] }
      - { zh: 包裹ID,         field: package_id,        type: id,       desc: "" }
      - { zh: 渠道ID,         field: channel_id,        type: id,       desc: "" }
      - { zh: 承运商ID,       field: carrier_id,        type: id,       desc: "" }
      - { zh: 发件地址,       field: ship_from,         type: json,     desc: "structs.address。" }
      - { zh: 收件地址,       field: ship_to,           type: json,     desc: "structs.address。" }
      - { zh: 运输方式,       field: transport_mode,    type: enum,     desc: "" }
      - { zh: 服务等级,       field: service_level,     type: enum,     desc: "" }
      - { zh: 清关条款,       field: incoterm,          type: enum,     desc: "" }
      - { zh: DDP代缴,        field: is_ddp,            type: bool,     desc: "" }
      - { zh: 件数,           field: piece_count,       type: int,      desc: "" }
      - { zh: 重量/尺寸,      field: dims,              type: json,     desc: "structs.dims。" }
      - { zh: 运费报价,       field: quoted,            type: json,     desc: "{currency,base_currency,fx_rate,freight,charges[]}。" }
      - { zh: 运单状态,       field: shipment_status,   type: enum,     desc: "" }
      - { zh: 揽收时间,       field: pickup_at,         type: datetime, desc: "" }
      - { zh: 发货时间,       field: depart_at,         type: datetime, desc: "离仓/起运时间（UTC）。" }
      - { zh: 发货截止时间,    field: ship_deadline_at,  type: datetime, desc: "该票应在此时间前发出（SLA/合规）。" }
      - { zh: 妥投时间,       field: delivered_at,      type: datetime, desc: "" }
      - { zh: 标签打印时间,    field: label_printed_at,  type: datetime, desc: "冗余：参考 label.label_printed_at。" }

  bag:
    desc: "集包袋。"
    fields:
      - { zh: 集包袋号,       field: bag_no,            type: string,   desc: "" }
      - { zh: 重量(kg),       field: weight_kg,         type: decimal,  desc: "" }
      - { zh: 明细运单,       field: waybill_nos,       type: array,    desc: "字符串数组。" }

  manifest:
    desc: "交接/装车清单。"
    fields:
      - { zh: 清单号,         field: manifest_no,       type: string,   desc: "" }
      - { zh: 来源仓,         field: from_warehouse_id, type: id,       desc: "" }
      - { zh: 目的地,         field: destination,       type: string,   desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{waybill_no,weight_kg}]。" }
      - { zh: 清单打印时间,    field: manifest_printed_at, type: datetime, desc: "清单被打印的时间（UTC）。" }

  route_plan:
    desc: "运输计划/路由。"
    fields:
      - { zh: 计划号,         field: route_plan_no,     type: string,   desc: "" }
      - { zh: 路由节点,       field: nodes,             type: array,    desc: "数组：[{node_type,eta,etd,location}]。" }

  customs_declaration:
    desc: "清关申报单。"
    fields:
      - { zh: 申报单号,       field: declaration_no,    type: string,   desc: "" }
      - { zh: 运单号,         field: waybill_no,        type: string,   desc: "" }
      - { zh: 发票号,         field: invoice_no,        type: string,   desc: "" }
      - { zh: 装箱单号,       field: packing_list_no,   type: string,   desc: "" }
      - { zh: 申报条目,       field: items,             type: array,    desc: "数组：[{sku,declare_name_zh,declare_name_en,hs_code,declare_value,declare_currency,qty,weight_kg,origin_country}]。" }
      - { zh: 税费明细,       field: duties_taxes,      type: array,    desc: "数组：[{type,amount,currency}]。" }
      - { zh: 清关口岸,       field: port_of_entry,     type: string,   desc: "" }
      - { zh: 放行时间,       field: released_at,       type: datetime, desc: "" }

  tms_settlement:
    desc: "TMS 费用结算。"
    fields:
      - { zh: 结算单号,       field: settlement_no,     type: string,   desc: "" }
      - { zh: 承运商ID,       field: carrier_id,        type: id,       desc: "" }
      - { zh: 账期,           field: billing_period,    type: string,   desc: "YYYYMM 或日期区间。" }
      - { zh: 费用汇总,       field: totals,            type: json,     desc: "{currency,freight,charges,grand_total}。" }
      - { zh: 对账状态,       field: reconcile_status,  type: string,   desc: "未对/对平/差异。" }

  claim:
    desc: "运输异常/索赔。"
    fields:
      - { zh: 运单号,         field: waybill_no,        type: string,   desc: "" }
      - { zh: 异常类型,       field: exception_type,    type: string,   desc: "" }
      - { zh: 原因代码,       field: reason_code,       type: enum,     desc: "" }
      - { zh: 索赔金额,       field: claim_amount,      type: decimal,  desc: "" }
      - { zh: 索赔币种,       field: claim_currency,    type: string,   desc: "" }
      - { zh: 结案时间,       field: closed_at,         type: datetime, desc: "" }

  # ------------------------ 换单/转单系统 ------------------------
  label_switch_rule:
    desc: "换单规则（何时/如何切换渠道/承运商）。"
    fields:
      - { zh: 规则编码,       field: rule_code,         type: string,   desc: "" }
      - { zh: 触发类型,       field: trigger_type,      type: enum,     desc: "见 enums.label_switch_trigger。" }
      - { zh: 条件表达式,     field: condition_expr,    type: string,   desc: "DSL/JSON。" }
      - { zh: 目标渠道ID,     field: target_channel_id, type: id,       desc: "" }
      - { zh: 生效期起,       field: valid_from,        type: datetime, desc: "" }
      - { zh: 生效期止,       field: valid_to,          type: datetime, desc: "" }
      - { zh: 审批必需,       field: is_approval_required, type: bool,  desc: "" }

  label_switch_task:
    desc: "换单任务（一次实际切换）。"
    fields:
      - { zh: 换单任务号,     field: label_switch_task_no, type: string, desc: "" }
      - { zh: 原面单号,       field: original_tracking_no, type: string, desc: "" }
      - { zh: 原渠道ID,       field: original_channel_id,  type: id,     desc: "" }
      - { zh: 新渠道ID,       field: new_channel_id,       type: id,     desc: "" }
      - { zh: 新面单号,       field: new_tracking_no,      type: string, desc: "" }
      - { zh: 转单号,         field: transfer_waybill_no,  type: string, desc: "此次换单流程产生的转单编号。" }
      - { zh: 触发来源,       field: triggered_by,         type: string, desc: "system/rule/manual。" }
      - { zh: 触发原因,       field: reason_code,          type: enum,   desc: "见 enums.label_switch_trigger。" }
      - { zh: 费用差异,       field: fee_diff,             type: decimal, desc: "基础币。" }
      - { zh: SLA影响,        field: sla_effect,           type: string, desc: "" }
      - { zh: 审批状态,       field: approval_status,      type: string, desc: "" }
      - { zh: 审批人ID,       field: approver_id,          type: id,     desc: "" }
      - { zh: 审批时间,       field: approved_at,          type: datetime, desc: "" }

  label_switch_mapping:
    desc: "新旧运单映射。"
    fields:
      - { zh: 转单号,         field: transfer_waybill_no,  type: string, desc: "连接 original/new 之间的中间转单号。" }
      - { zh: 原面单号,       field: original_tracking_no, type: string, desc: "" }
      - { zh: 新面单号,       field: new_tracking_no,      type: string, desc: "" }
      - { zh: 原运单号,       field: original_waybill_no,  type: string, desc: "" }
      - { zh: 新运单号,       field: new_waybill_no,       type: string, desc: "" }

  label_switch_audit:
    desc: "换单审计日志。"
    fields:
      - { zh: 任务ID,         field: task_id,            type: id,       desc: "" }
      - { zh: 动作,           field: action,             type: string,   desc: "create/approve/reject/apply/revert。" }
      - { zh: 内容快照,       field: snapshot,           type: json,     desc: "" }

  # ------------------------ WMS（预报/入库/上架/出库等） ------------------------
  asn_prealert:
    desc: "入库预报（ASN/预报单）。"
    fields:
      - { zh: 预报单号,       field: prealert_no,       type: string,   desc: "ASN/预报单号。" }
      - { zh: 预报类型,       field: inbound_type,      type: enum,     desc: "" }
      - { zh: 关联单据,       field: ref_doc,           type: json,     desc: "{type,id,no}。" }
      - { zh: 预计到仓时间,   field: eta_at,            type: datetime, desc: "" }
      - { zh: 目的仓ID,       field: dest_warehouse_id, type: id,       desc: "" }
      - { zh: 箱数,           field: cartons,           type: int,      desc: "" }
      - { zh: 托盘数,         field: pallets,           type: int,      desc: "" }
      - { zh: 运输单号,       field: transport_awb_no,  type: string,   desc: "" }
      - { zh: 预报状态,       field: asn_status,        type: enum,     desc: "" }

  inbound_order:
    desc: "入库单（WMS执行单据）。"
    fields:
      - { zh: 入库单号,       field: inbound_order_no,  type: string,   desc: "" }
      - { zh: 来源预报单号,   field: prealert_no,       type: string,   desc: "" }
      - { zh: 入库类型,       field: inbound_type,      type: enum,     desc: "" }
      - { zh: 关联采购单号,   field: po_no,             type: string,   desc: "" }
      - { zh: 关联调拨单号,   field: transfer_no,       type: string,   desc: "" }
      - { zh: 关联退供单号,   field: rtv_no,            type: string,   desc: "" }
      - { zh: 关联客退单号,   field: return_inbound_no, type: string,   desc: "" }
      - { zh: 入库状态,       field: inbound_status,    type: enum,     desc: "" }

  inbound_receipt:
    desc: "收货回执/入库回执（GRN）。"
    fields:
      - { zh: 入库回执号,     field: inbound_receipt_no, type: string,  desc: "" }
      - { zh: 入库单号,       field: inbound_order_no,   type: string,  desc: "" }
      - { zh: 收货时间,       field: received_at,        type: datetime, desc: "" }
      - { zh: 收货明细,       field: items,              type: array,   desc: "数组：[{sku,qty,qty_damaged,lot_no,serial_nos[]}]" }

  putaway_task:
    desc: "上架单/上架任务。"
    fields:
      - { zh: 上架单号,       field: putaway_no,        type: string,   desc: "" }
      - { zh: 入库回执号,     field: inbound_receipt_no, type: string,  desc: "" }
      - { zh: 上架策略,       field: putaway_strategy,  type: enum,     desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,from_bin,to_bin,qty}]。" }

  replenishment_task:
    desc: "补货单（库位间补货）。"
    fields:
      - { zh: 补货单号,       field: replenishment_no,  type: string,   desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,from_bin,to_bin,qty}]。" }

  move_order:
    desc: "移库单。"
    fields:
      - { zh: 移库单号,       field: move_order_no,     type: string,   desc: "" }
      - { zh: 移库原因,       field: move_reason,       type: enum,     desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,from_bin,to_bin,qty}]。" }
      - { zh: 移库状态,       field: move_status,       type: enum,     desc: "" }

  outbound_order:
    desc: "出库单（WMS执行单据）。"
    fields:
      - { zh: 出库单号,       field: outbound_order_no, type: string,   desc: "" }
      - { zh: 出库类型,       field: outbound_type,     type: enum,     desc: "" }
      - { zh: 关联销售订单号, field: sales_order_no,    type: string,   desc: "" }
      - { zh: 关联调拨单号,   field: transfer_no,       type: string,   desc: "" }
      - { zh: 出库状态,       field: outbound_status,   type: enum,     desc: "" }
      - { zh: 发货时间,       field: shipped_at,        type: datetime, desc: "该出库单对应包裹/运单的离仓时间（快照）。" }
      - { zh: 发货截止时间,    field: ship_deadline_at,  type: datetime, desc: "应在此时间前出库（SLA）。" }
      - { zh: 出库单打印时间,  field: outbound_printed_at, type: datetime, desc: "波次/出库单据被打印的时间（UTC）。" }

  wave:
    desc: "波次/下架任务（WMS）。"
    fields:
      - { zh: 波次号,         field: wave_no,           type: string,   desc: "" }
      - { zh: 规则快照,       field: rule_snapshot,     type: json,     desc: "" }

  shipping_order:
    desc: "发运单（WMS 打包/交接执行单）。"
    fields:
      - { zh: 发运单号,       field: shipment_order_no, type: string,   desc: "" }
      - { zh: 关联出库单号,   field: outbound_order_no, type: string,   desc: "" }
      - { zh: 打包人ID,       field: packer_id,         type: id,       desc: "" }
      - { zh: 包裹数,         field: package_count,     type: int,      desc: "" }
      - { zh: 总重(kg),       field: total_weight_kg,   type: decimal,  desc: "" }
      - { zh: 发运时间,       field: shipped_at,        type: datetime, desc: "交接/装车离站时间（UTC）。" }
      - { zh: 发运单打印时间,  field: shipment_printed_at, type: datetime, desc: "发运单被打印的时间（UTC）。" }

  return_inbound:
    desc: "退货入库单（客退）。"
    fields:
      - { zh: 退货入库单号,   field: return_inbound_no, type: string,   desc: "" }
      - { zh: 退货类型,       field: return_type,       type: enum,     desc: "" }
      - { zh: 关联运单号,     field: waybill_no,        type: string,   desc: "" }
      - { zh: 关联订单号,     field: sales_order_no,    type: string,   desc: "" }

  rtv_order:
    desc: "退供单（退回供应商）。"
    fields:
      - { zh: 退供单号,       field: rtv_no,            type: string,   desc: "" }
      - { zh: 关联采购单号,   field: po_no,             type: string,   desc: "" }
      - { zh: 明细,           field: items,             type: array,    desc: "数组：[{sku,qty,reason}]。" }

  transshipment_order:
    desc: "中转单（跨仓/头程中转）。"
    fields:
      - { zh: 中转单号,       field: transshipment_no,  type: string,   desc: "" }
      - { zh: 起运仓ID,       field: from_warehouse_id, type: id,       desc: "" }
      - { zh: 目的仓ID,       field: to_warehouse_id,   type: id,       desc: "" }
      - { zh: 运输单号,       field: transport_awb_no,  type: string,   desc: "" }

  # ------------------------ 集成/对接/幂等/重试 ------------------------
  integration_auth:
    desc: "对接授权（外部系统）。"
    fields:
      - { zh: 渠道代码,       field: sales_channel_code, type: string,  desc: "" }
      - { zh: 店铺ID,         field: store_id,           type: id,      desc: "" }
      - { zh: AppKey,         field: app_key,            type: string,  desc: "" }
      - { zh: AppSecret,      field: app_secret,         type: string,  desc: "" }
      - { zh: AccessToken,    field: access_token,       type: string,  desc: "" }
      - { zh: RefreshToken,   field: refresh_token,      type: string,  desc: "" }
      - { zh: Token过期时间,  field: token_expires_at,   type: datetime, desc: "" }
      - { zh: 回调URL,        field: callback_url,       type: string,  desc: "" }

  integration_job:
    desc: "对接任务（拉单/回传/同步）。"
    fields:
      - { zh: 任务类型,       field: job_type,           type: string,  desc: "pull_orders/push_shipments 等。" }
      - { zh: 渠道代码,       field: sales_channel_code, type: string,  desc: "" }
      - { zh: 店铺ID,         field: store_id,           type: id,      desc: "" }
      - { zh: 同步游标,       field: sync_cursor,        type: string,  desc: "" }
      - { zh: 执行状态,       field: exec_status,        type: string,  desc: "pending/running/success/failed。" }
      - { zh: 重试次数,       field: retry_count,        type: int,     desc: "" }
      - { zh: 上次错误,       field: last_error,         type: string,  desc: "" }
      - { zh: 任务明细,       field: payload,            type: json,    desc: "" }
      - { zh: 完成时间,       field: finished_at,        type: datetime, desc: "" }

  webhook_event:
    desc: "Webhook 出入站事件。"
    fields:
      - { zh: 事件键,         field: event_key,          type: string,  desc: "" }
      - { zh: 主题,           field: topic,              type: string,  desc: "" }
      - { zh: 负载,           field: payload,            type: json,    desc: "" }
      - { zh: 目标URL,        field: target_url,         type: string,  desc: "" }
      - { zh: 投递状态,       field: delivery_status,    type: string,  desc: "pending/sent/failed。" }
      - { zh: 签名,           field: signature,          type: string,  desc: "" }

  idempotency_key:
    desc: "幂等键（请求去重）。"
    fields:
      - { zh: 幂等键,         field: idempotency_key,    type: string,  desc: "" }
      - { zh: 过期时间,       field: expires_at,         type: datetime, desc: "" }
      - { zh: 结果快照,       field: result_snapshot,    type: json,    desc: "" }

  retry_task:
    desc: "失败重试队列。"
    fields:
      - { zh: 任务类型,       field: task_type,          type: string,  desc: "" }
      - { zh: 负载,           field: payload,            type: json,    desc: "" }
      - { zh: 下次时间,       field: next_attempt_at,    type: datetime, desc: "" }
      - { zh: 已重试次数,     field: retry_count,        type: int,     desc: "" }
      - { zh: 最大重试,       field: max_retries,        type: int,     desc: "" }

  # ------------------------ 系统/审计/配置 ------------------------
  audit_log:
    desc: "系统审计日志。"
    fields:
      - { zh: 动作,           field: action,             type: string,  desc: "create/update/delete/login 等。" }
      - { zh: 目标对象,       field: target,             type: json,    desc: "{type,id}。" }
      - { zh: 变更前,         field: before,             type: json,    desc: "" }
      - { zh: 变更后,         field: after,              type: json,    desc: "" }
      - { zh: 客户端IP,       field: client_ip,          type: string,  desc: "" }
      - { zh: UA,             field: user_agent,         type: string,  desc: "" }
      - { zh: 追踪ID,         field: trace_id,           type: string,  desc: "" }

  file_object:
    desc: "文件/附件对象。"
    fields:
      - { zh: 存储键,         field: storage_key,        type: string,  desc: "" }
      - { zh: 文件名,         field: file_name,          type: string,  desc: "" }
      - { zh: MIME类型,       field: mime_type,          type: string,  desc: "" }
      - { zh: 大小(字节),     field: size_bytes,         type: int,     desc: "" }
      - { zh: 摘要/哈希,      field: content_hash,       type: string,  desc: "" }

  settings:
    desc: "租户/系统设置。"
    fields:
      - { zh: 键,             field: key,                type: string,  desc: "" }
      - { zh: 值,             field: value,              type: json,    desc: "" }
      - { zh: 作用域,         field: scope,              type: string,  desc: "tenant/org/user。" }

  numbering_rule:
    desc: "编号规则（code/no 生成）。"
    fields:
      - { zh: 规则编码,       field: rule_code,          type: string,  desc: "" }
      - { zh: 作用实体,       field: target_entity,      type: string,  desc: "如 sales_order/waybill 等。" }
      - { zh: 模板,           field: pattern,            type: string,  desc: "如 SO{yyyy}{seq%5}。" }
      - { zh: 序列长度,       field: seq_len,            type: int,     desc: "" }
      - { zh: 重置策略,       field: reset_scope,        type: string,  desc: "daily/monthly/yearly/never。" }

  risk_rule:
    desc: "风控规则。"
    fields:
      - { zh: 规则编码,       field: rule_code,          type: string,  desc: "" }
      - { zh: 规则类型,       field: rule_type,          type: string,  desc: "地址/支付/商品/渠道等。" }
      - { zh: 条件表达式,     field: condition_expr,     type: string,  desc: "" }
      - { zh: 风险级别,       field: risk_level,         type: enum,    desc: "见 enums.risk_level。" }
      - { zh: 动作,           field: action,             type: string,  desc: "拦截/人工复核/放行。" }

  # ------------------------ 报表示例（事实/维度） ------------------------
  fact_sales:
    desc: "销售事实表（聚合）。"
    fields:
      - { zh: 日期键,         field: date_key,           type: date,    desc: "YYYY-MM-DD。" }
      - { zh: 店铺ID,         field: store_id,           type: id,      desc: "" }
      - { zh: SKU,            field: sku,                type: string,  desc: "" }
      - { zh: 订单数,         field: order_cnt,          type: int,     desc: "" }
      - { zh: 件数,           field: item_qty,           type: decimal, desc: "" }
      - { zh: 销售额,         field: sales_amount,       type: decimal, desc: "" }
      - { zh: 退款额,         field: refund_amount,      type: decimal, desc: "" }

  fact_shipment:
    desc: "出运事实表（聚合）。"
    fields:
      - { zh: 日期键,         field: date_key,           type: date,    desc: "" }
      - { zh: 渠道ID,         field: channel_id,         type: id,      desc: "" }
      - { zh: 出运票数,       field: waybill_cnt,        type: int,     desc: "" }
      - { zh: 总重量(kg),     field: total_weight_kg,    type: decimal, desc: "" }
      - { zh: 平均时效(天),   field: avg_transit_days,   type: decimal, desc: "" }
      - { zh: 异常率(%),      field: exception_rate_pct, type: decimal, desc: "" }

reserved:
  prefix: "ext_"
  udf_fields: [ udf_01, udf_02, udf_03, udf_04, udf_05, udf_06, udf_07, udf_08, udf_09, udf_10,
                udf_11, udf_12, udf_13, udf_14, udf_15, udf_16, udf_17, udf_18, udf_19, udf_20,
                udf_21, udf_22, udf_23, udf_24, udf_25, udf_26, udf_27, udf_28, udf_29, udf_30,
                udf_31, udf_32, udf_33, udf_34, udf_35, udf_36, udf_37, udf_38, udf_39, udf_40,
                udf_41, udf_42, udf_43, udf_44, udf_45, udf_46, udf_47, udf_48, udf_49, udf_50 ]

